(()=>{const e=document.querySelector(".main"),t=document.querySelector(".overlay"),n=document.querySelector(".input-board"),r=document.querySelector(".form-overlay"),s=(document.querySelector(".btn-send-overlay"),document.querySelector(".nav-menu")),o=document.querySelector(".btn-menu"),c=document.querySelector(".btn-cancel"),a=document.querySelector(".form-chatbox");let i,d,l;async function u(e="",t="",n="GET",r){try{const s={method:n,mode:"cors",credentials:"include",withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Origin":'"https://my-chatbot-api.onrender.com"'}},o=JSON.stringify({username:r});"POST"==n&&(s.body=o);const c=await fetch(`https://my-chatbot-api.onrender.com/api/v1/chatbot${e?"/":""}${e}${t?"/":""}${t}`,s);return await c.json()}catch(e){v({message:"The server is down at this time, please try again later"})}}function m(t){e.insertAdjacentHTML("afterbegin",t)}function p(t){e.removeChild(t)}function v(t){const n=function(e){const t=e.data;if(!t)return"";if(t.instructions){const e=document.createElement("p");return t.instructions.forEach((t=>{e.insertAdjacentHTML("beforeend",`<strong>${t.option}</strong>. ${t.instruction} <br/>`)})),e.innerHTML}if(t.Items){const e=document.createElement("p");return t.Items.forEach((t=>{e.insertAdjacentHTML("beforeend",`<strong>${t.id}</strong>. ${t.item} <br/>`)})),e.innerHTML}if(t.orders){const e=document.createElement("div");let n=0;return t.orders.forEach((t=>{const r=`\n        <div class="orders"> \n        <strong>ORDER ${++n}:</strong>\n          <div class="order-items"> <strong>Date -</strong> <p>${t.dateCreated}</p></div>\n          <p> <strong>count -</strong> You Bought ${t.itemsCount} item(s)</p>\n          <div class="order-items">\n            <strong class="order-label">Items - </strong>\n            <p> ${t.items.map((e=>` ${e.item}`))}</p>\n          </div>\n          <p> <strong>Total Amount -</strong> $${t.amount}</p>\n        </div>\n        <br/>\n      `;e.insertAdjacentHTML("beforeend",r)})),e.innerHTML}if(t.order){const e=document.createElement("div"),{itemsCount:n,items:r,amount:s}=t.order,o=`\n        <div> \n          <p>${n} item(s) selected</p>\n          <span>Total Amount: $${s}</span>\n        </div>\n      `;return e.insertAdjacentHTML("beforeend",o),e.innerHTML}if(t.currentOrder){const e=document.createElement("div");let n=0;const{itemsCount:r,items:s,amount:o}=t.currentOrder,c=`\n        <div> \n          <p>${r} item(s) selected</p>\n           <p>${s.map((e=>`<strong>${++n}</strong>. ${e.item} - $${e.amount}<br/>`))}</p>\n          <span>Total Amount: $${o}</span>\n        </div>\n        <br/>\n      `;return e.insertAdjacentHTML("beforeend",c),e.innerHTML}}(t),r=["Order cancelledüòì.","Order Placedüëç."];r.includes(t.message)&&(l="");const s=`\n    <div class="msg server-message">\n      <p>${t.message}</p>\n      ${n?"<br/>":""}\n        ${n}\n        <br/>\n        ${r.includes(t.message)?"<br/> Select 1 to place new order":""}\n    </div>\n  `;e.insertAdjacentHTML("afterbegin",s)}o.addEventListener("click",(function(){s.classList.remove("hide-menu"),s.classList.add("show-menu")})),c.addEventListener("click",(function(){s.classList.remove("show-menu"),s.classList.add("hide-menu")})),r.addEventListener("submit",(async e=>{if(e.preventDefault(),d=e.target.elements["form-overlay-input"].value,!d)return;f(i,m);const r=document.querySelector(".dots");t.classList.add("hide"),n.classList.add("hide"),i=await u("","","POST",d),p(r),v(i),i=""})),a.addEventListener("submit",(async t=>{t.preventDefault();let n=t.target.elements["chatbox-input"].value;if(!n.trim())return;!function(t){const n=`\n        <div class="msg client-message">\n          <p>${t}</p>\n        </div>`;e.insertAdjacentHTML("afterbegin",n)}(n),f(i,m);const r=document.querySelector(".dots"),s=["99","98","97","0"];if(Number(n)>99||n>10&&n<97||isNaN(n)||!l&&1!=n&&!s.includes(n))return setTimeout((async()=>{p(r),v({message:"Please make a request using bot instructions"}),v({message:"a. Select 1 to Place an order <br/> b. Select 99 to checkout order <br/> c. Select 98 to see order history <br/> d. Select 97 to see current order <br/> e. Select 0 to cancel order. <br/> <br/> or select items using their respective numbers."})}),1500),void(t.target.elements["chatbox-input"].value="");t.target.elements["chatbox-input"].value="",n&&(1==l&&n&&!s.includes(n)&&(i=await u(l,n)),l||"1"!=n||(i=await u(n)),s.includes(n)&&(i=await u(n)),p(r),v(i),"1"==n&&(l=n)),i=""}));const b=document.querySelector(".nav-theme-icon");function f(e,t){e||t('\n    <div class="dots">\n        <span class="dot dot-1"></span>\n        <span class="dot dot-2"></span>\n        <span class="dot dot-3"></span>\n    </div>\n    ')}b.addEventListener("click",(function(){b.children[1].textContent="Light mode"==b.children[1].textContent?"Dark mode":"Light mode","Dark mode"==b.children[1].textContent?(b.children[0].classList.remove("fa-sun"),b.children[0].classList.add("fa-moon"),document.documentElement.classList.add("dark")):(b.children[0].classList.remove("fa-moon"),b.children[0].classList.add("fa-sun"),document.documentElement.classList.remove("dark"))}))})();